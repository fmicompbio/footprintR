<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot single-molecule footprinting data for a single genomic region. — plotRegion • footprintR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot single-molecule footprinting data for a single genomic region. — plotRegion"><meta property="og:description" content="This function will visualize read-level or collapsed single-molecule
footprinting data, such as data imported using readModkitExtract
or readBedMethyl."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">footprintR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/read-level-data.html">Exploring read-level footprinting data with `footprintR`</a>
    </li>
    <li>
      <a href="../articles/using-footprintR.html">Using `footprintR`</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fmicompbio/footprintR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot single-molecule footprinting data for a single genomic region.</h1>
    <small class="dont-index">Source: <a href="https://github.com/fmicompbio/footprintR/blob/devel/R/plotRegion.R" class="external-link"><code>R/plotRegion.R</code></a></small>
    <div class="hidden name"><code>plotRegion.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function will visualize read-level or collapsed single-molecule
footprinting data, such as data imported using <code><a href="readModkitExtract.html">readModkitExtract</a></code>
or <code><a href="readBedMethyl.html">readBedMethyl</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotRegion</span><span class="op">(</span></span>
<span>  <span class="va">se</span>,</span>
<span>  region <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tracks.reads <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tracks.summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>FracMod <span class="op">=</span> <span class="st">"Point"</span><span class="op">)</span>,</span>
<span>  modbaseSpace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sequence.context <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></code> object
with read-level or collapsed single-molecule footprinting data (positions
in rows and reads or samples in columns).</p></dd>


<dt id="arg-region">region<a class="anchor" aria-label="anchor" href="#arg-region"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></code> object with a single
region. Only data from <code>se</code> overlapping this region will be plotted.
Alternatively, the region can be specified as a character scalar (e.g.
"chr1:1200-1300") that can be coerced into a <code>GRanges</code> object. If
<code>NULL</code> (the default), all the data on the first sequence in
<code>se</code> will be visualized.</p></dd>


<dt id="arg-tracks-reads">tracks.reads<a class="anchor" aria-label="anchor" href="#arg-tracks-reads"></a></dt>
<dd><p>A named list where the names correspond to assay names
of read-level assays in <code>se</code> and the values are character vectors
with the plot types to make for each assay. Currently supported plot
types are:</p><ul><li><p><code>"Lollipop"</code>: Lollipop plot (filled circles with the
color representing the values in the assay).</p></li>
<li><p><code>"Heatmap"</code>: Heatmap plot (tiles with the color
represeting the values in the assay).</p></li>
</ul><p>If <code>NULL</code>, do not plot any read-level tracks.</p></dd>


<dt id="arg-tracks-summary">tracks.summary<a class="anchor" aria-label="anchor" href="#arg-tracks-summary"></a></dt>
<dd><p>A named list where the names correspond to assay names
of summarized data in <code>se</code> and the values are character vectors with
plot types to make for each assay. Currently supported plot types are:</p><ul><li><p><code>Point</code>: A point plot displaying values in the assay.</p></li>
<li><p><code>Smooth</code>: A smoothed line plot displaying values in the
assay.</p></li>
<li><p><code>PointSmooth</code>: A point and smoothed line plot displaying
values in the assay.</p></li>
</ul><p>If <code>NULL</code>, do not plot any summary data tracks.
A special case is the track name <code>"FracMod"</code>: If <code>se</code> does not
contain an assay of that name, but <code>"Nmod"</code> and <code>"Nvalid"</code>
assays are available, <code>"FracMod"</code> will be calculated from
<code>assay(se, "Nmod") / assay(se, "Nvalid")</code>.</p></dd>


<dt id="arg-modbasespace">modbaseSpace<a class="anchor" aria-label="anchor" href="#arg-modbasespace"></a></dt>
<dd><p>A logical scalar. If <code>TRUE</code>, the x-axis will be
shown in the space of modified bases and contain only the positions at
which there are modified bases in the data without any gaps between them.
If <code>FALSE</code>, the x-axis will show the genomic coordinate on which
the modified bases are typically irregularly spaced.</p></dd>


<dt id="arg-sequence-context">sequence.context<a class="anchor" aria-label="anchor" href="#arg-sequence-context"></a></dt>
<dd><p>A character vector with sequence context(s)
to plot. Only positions that match one of the provided sequence
contexts will be included in the plot. Sequence contexts can be provided
using IUPAC redundancy codes. The sequence contexts of modified bases are
obtained from <code>rowData(se)$sequence.context</code> and thus requires that
<code>se</code> contains the appropriate information, for example by setting
the <code>sequence.context</code> and <code>sequence.reference</code> arguments of
<code><a href="readBedMethyl.html">readBedMethyl</a></code> when it was generated, or by adding it using
<code><a href="seqContext.html">seqContext</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></code> object with tracks selected by
<code>tracks.reads</code> and <code>tracks.summary</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="readModkitExtract.html">readModkitExtract</a></code> and <code><a href="readBedMethyl.html">readBedMethyl</a></code> for
reading read-level and summarized footprinting data.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Charlotte Soneson, Michael Stadler</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># summarized data (5mC)</span></span></span>
<span class="r-in"><span><span class="va">bmfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modkit_pileup_1.bed.gz"</span>, <span class="st">"modkit_pileup_2.bed.gz"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       package <span class="op">=</span> <span class="st">"footprintR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">reffile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"reference.fa.gz"</span>, package <span class="op">=</span> <span class="st">"footprintR"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">seA</span> <span class="op">&lt;-</span> <span class="fu"><a href="readBedMethyl.html">readBedMethyl</a></span><span class="op">(</span><span class="va">bmfiles</span>, sequence.context <span class="op">=</span> <span class="fl">3</span>, sequence.reference <span class="op">=</span> <span class="va">reffile</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seA</span>, region <span class="op">=</span> <span class="st">"chr1:6940000-6955000"</span>, sequence.context <span class="op">=</span> <span class="st">"GCH"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seA</span>, region <span class="op">=</span> <span class="st">"chr1:6940000-6955000"</span>, sequence.context <span class="op">=</span> <span class="st">"HCG"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seA</span>, region <span class="op">=</span> <span class="st">"chr1:6940000-6955000"</span>,</span></span>
<span class="r-in"><span>           tracks.summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Nvalid <span class="op">=</span> <span class="st">"Smooth"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># read-level data (6mA)</span></span></span>
<span class="r-in"><span><span class="va">extractfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modkit_extract_rc_6mA_1.tsv.gz"</span>,</span></span>
<span class="r-in"><span>                              <span class="st">"modkit_extract_rc_6mA_2.tsv.gz"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            package <span class="op">=</span> <span class="st">"footprintR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">seB</span> <span class="op">&lt;-</span> <span class="fu"><a href="readModkitExtract.html">readModkitExtract</a></span><span class="op">(</span><span class="va">extractfiles</span>, modbase <span class="op">=</span> <span class="st">"a"</span>, filter <span class="op">=</span> <span class="st">"modkit"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seB</span>, region <span class="op">=</span> <span class="st">"chr1:6935800-6935900"</span>,</span></span>
<span class="r-in"><span>           tracks.summary <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>           tracks.reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod_prob <span class="op">=</span> <span class="st">"Lollipop"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seB</span>, region <span class="op">=</span> <span class="st">"chr1:6935800-6935900"</span>,</span></span>
<span class="r-in"><span>           tracks.summary <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>           tracks.reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod_prob <span class="op">=</span> <span class="st">"Heatmap"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seB</span>, region <span class="op">=</span> <span class="st">"chr1:6935400-6935450"</span>,</span></span>
<span class="r-in"><span>           tracks.summary <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>           tracks.reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod_prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lollipop"</span>, <span class="st">"Heatmap"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           modbaseSpace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael Stadler, Charlotte Soneson, Panagiotis Papasaikas, Sebastien Smallwood.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

      </footer></div>






  </body></html>

