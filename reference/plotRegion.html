<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot single-molecule footprinting data for a single genomic region. — plotRegion • footprintR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot single-molecule footprinting data for a single genomic region. — plotRegion"><meta name="description" content="This function will visualize read-level or collapsed single-molecule
footprinting data, such as data imported using readModkitExtract
or readBedMethyl."><meta property="og:description" content="This function will visualize read-level or collapsed single-molecule
footprinting data, such as data imported using readModkitExtract
or readBedMethyl."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">footprintR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/read-level-data.html">Exploring read-level footprinting data with `footprintR`</a></li>
    <li><a class="dropdown-item" href="../articles/using-footprintR.html">Using `footprintR`</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fmicompbio/footprintR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot single-molecule footprinting data for a single genomic region.</h1>
      <small class="dont-index">Source: <a href="https://github.com/fmicompbio/footprintR/blob/devel/R/plotRegion.R" class="external-link"><code>R/plotRegion.R</code></a></small>
      <div class="d-none name"><code>plotRegion.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function will visualize read-level or collapsed single-molecule
footprinting data, such as data imported using <code><a href="readModkitExtract.html">readModkitExtract</a></code>
or <code><a href="readBedMethyl.html">readBedMethyl</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotRegion</span><span class="op">(</span></span>
<span>  <span class="va">se</span>,</span>
<span>  region <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tracks.reads <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tracks.summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>FracMod <span class="op">=</span> <span class="st">"Point"</span><span class="op">)</span>,</span>
<span>  modbaseSpace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sequence.context <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></code> object
with read-level or collapsed single-molecule footprinting data (positions
in rows and reads or samples in columns).</p></dd>


<dt id="arg-region">region<a class="anchor" aria-label="anchor" href="#arg-region"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></code> object with a single
region. Only data from <code>se</code> overlapping this region will be plotted.
Alternatively, the region can be specified as a character scalar (e.g.
"chr1:1200-1300") that can be coerced into a <code>GRanges</code> object. If
<code>NULL</code> (the default), all the data on the first sequence in
<code>se</code> will be visualized.</p></dd>


<dt id="arg-tracks-reads">tracks.reads<a class="anchor" aria-label="anchor" href="#arg-tracks-reads"></a></dt>
<dd><p>A named list where the names correspond to assay names
of read-level assays in <code>se</code> and the values are character vectors
with the plot types to make for each assay. Currently supported plot
types are:</p><dl><dt><code>"Lollipop"</code></dt>
<dd><p>: Lollipop plot (filled circles with the
color representing the values in the assay).</p></dd>

<dt><code>"Heatmap"</code></dt>
<dd><p>: Heatmap plot (tiles with the color
represeting the values in the assay).</p></dd>


</dl><p>If <code>NULL</code>, do not plot any read-level tracks.</p></dd>


<dt id="arg-tracks-summary">tracks.summary<a class="anchor" aria-label="anchor" href="#arg-tracks-summary"></a></dt>
<dd><p>A named list where the names correspond to assay names
of summarized data in <code>se</code> and the values are character vectors with
plot types to make for each assay. Currently supported plot types are:</p><dl><dt><code>Point</code></dt>
<dd><p>: A point plot displaying values in the assay.</p></dd>

<dt><code>Smooth</code></dt>
<dd><p>: A smoothed line plot displaying values in the
assay.</p></dd>

<dt><code>PointSmooth</code></dt>
<dd><p>: A point and smoothed line plot displaying
values in the assay.</p></dd>


</dl><p>If <code>NULL</code>, do not plot any summary data tracks.
A special case is the track name <code>"FracMod"</code>: If <code>se</code> does not
contain an assay of that name, but <code>"Nmod"</code> and <code>"Nvalid"</code>
assays are available, <code>"FracMod"</code> will be calculated from
<code>assay(se, "Nmod") / assay(se, "Nvalid")</code>.</p></dd>


<dt id="arg-modbasespace">modbaseSpace<a class="anchor" aria-label="anchor" href="#arg-modbasespace"></a></dt>
<dd><p>A logical scalar. If <code>TRUE</code>, the x-axis will be
shown in the space of modified bases and contain only the positions at
which there are modified bases in the data without any gaps between them.
If <code>FALSE</code>, the x-axis will show the genomic coordinate on which
the modified bases are typically irregularly spaced.</p></dd>


<dt id="arg-sequence-context">sequence.context<a class="anchor" aria-label="anchor" href="#arg-sequence-context"></a></dt>
<dd><p>A character vector with sequence context(s)
to plot. Only positions that match one of the provided sequence
contexts will be included in the plot. Sequence contexts can be provided
using IUPAC redundancy codes. The sequence contexts of modified bases are
obtained from <code>rowData(se)$sequence.context</code> and thus requires that
<code>se</code> contains the appropriate information, for example by setting
the <code>sequence.context</code> and <code>sequence.reference</code> arguments of
<code><a href="readBedMethyl.html">readBedMethyl</a></code> when it was generated, or by adding it using
<code><a href="addSeqContext.html">addSeqContext</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></code> object with tracks selected by
<code>tracks.reads</code> and <code>tracks.summary</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="readModkitExtract.html">readModkitExtract</a></code> and <code><a href="readBedMethyl.html">readBedMethyl</a></code> for
reading read-level and summarized footprinting data.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Charlotte Soneson, Michael Stadler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># summarized data (5mC)</span></span></span>
<span class="r-in"><span><span class="va">bmfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modkit_pileup_1.bed.gz"</span>, <span class="st">"modkit_pileup_2.bed.gz"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       package <span class="op">=</span> <span class="st">"footprintR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">reffile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"reference.fa.gz"</span>, package <span class="op">=</span> <span class="st">"footprintR"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">seA</span> <span class="op">&lt;-</span> <span class="fu"><a href="readBedMethyl.html">readBedMethyl</a></span><span class="op">(</span><span class="va">bmfiles</span>, sequence.context <span class="op">=</span> <span class="fl">3</span>, sequence.reference <span class="op">=</span> <span class="va">reffile</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seA</span>, region <span class="op">=</span> <span class="st">"chr1:6940000-6955000"</span>, sequence.context <span class="op">=</span> <span class="st">"GCH"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seA</span>, region <span class="op">=</span> <span class="st">"chr1:6940000-6955000"</span>, sequence.context <span class="op">=</span> <span class="st">"HCG"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seA</span>, region <span class="op">=</span> <span class="st">"chr1:6940000-6955000"</span>,</span></span>
<span class="r-in"><span>           tracks.summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Nvalid <span class="op">=</span> <span class="st">"Smooth"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># read-level data (6mA)</span></span></span>
<span class="r-in"><span><span class="va">extractfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modkit_extract_rc_6mA_1.tsv.gz"</span>,</span></span>
<span class="r-in"><span>                              <span class="st">"modkit_extract_rc_6mA_2.tsv.gz"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            package <span class="op">=</span> <span class="st">"footprintR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">seB</span> <span class="op">&lt;-</span> <span class="fu"><a href="readModkitExtract.html">readModkitExtract</a></span><span class="op">(</span><span class="va">extractfiles</span>, modbase <span class="op">=</span> <span class="st">"a"</span>, filter <span class="op">=</span> <span class="st">"modkit"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seB</span>, region <span class="op">=</span> <span class="st">"chr1:6935800-6935900"</span>,</span></span>
<span class="r-in"><span>           tracks.summary <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>           tracks.reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod_prob <span class="op">=</span> <span class="st">"Lollipop"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seB</span>, region <span class="op">=</span> <span class="st">"chr1:6935800-6935900"</span>,</span></span>
<span class="r-in"><span>           tracks.summary <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>           tracks.reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod_prob <span class="op">=</span> <span class="st">"Heatmap"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotRegion</span><span class="op">(</span><span class="va">seB</span>, region <span class="op">=</span> <span class="st">"chr1:6935400-6935450"</span>,</span></span>
<span class="r-in"><span>           tracks.summary <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>           tracks.reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod_prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lollipop"</span>, <span class="st">"Heatmap"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           modbaseSpace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRegion-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Stadler, Charlotte Soneson, Panagiotis Papasaikas, Sebastien Smallwood.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

    </footer></div>





  </body></html>

