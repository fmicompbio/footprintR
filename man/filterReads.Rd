% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filterReads.R
\name{filterReads}
\alias{filterReads}
\title{Filter reads}
\usage{
filterReads(
  se,
  assay.type.read = "mod_prob",
  readInfoCol = "read_info",
  qcCol = "QC",
  minQscore = 0,
  minEntropy = 0,
  minReadLength = 0,
  minAlignedLength = 0,
  minAlignedFraction = 0,
  prune = TRUE
)
}
\arguments{
\item{se}{A \code{SummarizedExperiment} object.}

\item{assay.type.read}{A character scalar providing the name of a read-level
assay in \code{se}. This assay will be used to extract read names, as
well as to filter out any read that is not overlapping any of the
positions in the object.}

\item{readInfoCol}{A character scalar providing the name of the column in
\code{colData} that contains read info. Can be \code{NULL} if no such
column exists.}

\item{qcCol}{A character scalar providing the name of the column in
\code{colData} that contains quality metrics (calculated by
\code{calcReadStats}). Can be \code{NULL} if no such column exists.}

\item{minQscore}{A numeric scalar representing the smallest acceptable
read-level Qscore. Reads with Qscore below this value will be filtered
out.}

\item{minEntropy}{A numeric scalar representing the smallest acceptable
read-level entropy. Reads with entropy below this value will be filtered
out.}

\item{minReadLength}{A numeric scalar representing the smallest acceptable
read length. Reads that are shorter than this value will be filtered
out.}

\item{minAlignedLength}{A numeric scalar representing the smallest acceptable
aligned length. Reads with aligned length shorter than this value will
be filtered out.}

\item{minAlignedFraction}{A numeric scalar representing the smallest
acceptable aligned fraction of a read. Reads where the aligned fraction
is smaller than this value will be filtered out.}

\item{prune}{A logical scalar. If \code{TRUE} (the default), samples for
which the filtering retains none of the reads will be completely removed
from the returned \code{SummarizedExperiment} (also from \code{colData}
and from assays that do not store read-level data). If \code{FALSE},
such samples are retained (in the assays with read-level data as a
zero-column \code{SparseMatrix}).}
}
\value{
A filtered \code{SummarizedExperiment} object. The metadata of this
object contains a slot named \code{filteredOutReads}, which tabulate all
reads that are filtered out, together with the reason(s) for exclusion.
}
\description{
Filter reads
}
\examples{
library(SummarizedExperiment)
modbamfile <- system.file("extdata", "6mA_1_10reads.bam",
                          package = "footprintR")
se <- readModBam(bamfile = modbamfile, regions = "chr1:6920000-6995000",
           modbase = "a", verbose = TRUE)
se <- addReadStats(se, name = "QC")
sefilt <- filterReads(se, minQscore = 14, minAlignedLength = 10000)


}
\author{
Charlotte Soneson
}
