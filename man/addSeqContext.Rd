% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seqContext.R
\name{addSeqContext}
\alias{addSeqContext}
\title{Add sequence context around positions of interest to a SummarizedExperiment.}
\usage{
addSeqContext(x, sequence.context.width, sequence.reference)
}
\arguments{
\item{x}{A \code{\link[SummarizedExperiment]{RangedSummarizedExperiment}}.}

\item{sequence.context.width}{A numeric scalar giving the width of the
sequence context to be extracted from the reference
(\code{sequence.reference} argument). This must be an odd number
so that the sequence can be centered on the modified base.
If \code{sequence.context.width = 0} (the default), no
sequence context will be extracted.}

\item{sequence.reference}{A \code{\link[BSgenome]{BSgenome}} object, or a
character scalar giving the path to a fasta formatted file with reference
sequences, or a \code{\link[Biostrings]{DNAStringSet}} object.
The sequence context (see \code{sequence.context.width} argument) will be
extracted from these sequences.}
}
\value{
A \code{\link[SummarizedExperiment]{RangedSummarizedExperiment}}
object with sequence contexts added as a
\code{\link[Biostrings]{DNAStringSet}} object to
\code{rowData(x)$sequence.context}.
}
\description{
Convenience function to extract sequence context around positions of
interest (the \code{\link[SummarizedExperiment]{rowRanges}} of
a \code{\link[SummarizedExperiment]{RangedSummarizedExperiment}}) and
add them the the \code{\link[SummarizedExperiment]{SummarizedExperiment}}'s
row data (\code{rowData(se)$sequence.context}). The extracted sequences
will correspond to the regions defined as
\code{resize(rowRanges(x), width = sequence.context.width, fix = "center"}.
Sequence contexts are extracted using \code{\link{extractSeqContext}}.
}
\examples{
# load package
library(SummarizedExperiment)

# file with sequence in fasta format of length 6957060
reffile <- system.file("extdata", "reference.fa.gz", package = "footprintR")

# define some regions at the end of the reference sequence
se <- SummarizedExperiment(
          assays = matrix(1:3, ncol=1),
          rowRanges = GRanges(
              "chr1", IRanges(start = 6957060 - c(4, 2, 0),
              width = 1, names = c("a","b","c")),
              strand = "-"))

# add sequence context (note the padding with N's)
rowRanges(se)
se <- addSeqContext(se, 7, reffile)
rowRanges(se)

}
\seealso{
\code{\link{extractSeqContext}}
}
\author{
Michael Stadler
}
