% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotRegion.R
\name{plotRegion}
\alias{plotRegion}
\title{Plot single-molecule footprinting data for a single genomic region.}
\usage{
plotRegion(
  se,
  region = NULL,
  tracks.reads = NULL,
  tracks.summary = list(FracMod = "Point"),
  modbaseSpace = FALSE,
  sequence.context = NULL
)
}
\arguments{
\item{se}{A \code{\link[SummarizedExperiment]{SummarizedExperiment}} object
with read-level or collapsed single-molecule footprinting data (positions
in rows and reads or samples in columns).}

\item{region}{A \code{\link[GenomicRanges]{GRanges}} object with a single
region. Only data from \code{se} overlapping this region will be plotted.
Alternatively, the region can be specified as a character scalar (e.g.
"chr1:1200-1300") that can be coerced into a \code{GRanges} object. If
\code{NULL} (the default), all the data on the first sequence in
\code{se} will be visualized.}

\item{tracks.reads}{A named list where the names correspond to assay names
of read-level assays in \code{se} and the values are character vectors
with the plot types to make for each assay. Currently supported plot
types are:
\describe{
\item{\code{"Lollipop"}}{: Lollipop plot (filled circles with the
color representing the values in the assay).}
\item{\code{"Heatmap"}}{: Heatmap plot (tiles with the color
representing the values in the assay).}
\item{\code{"HeatmapFilled"}}{: Heatmap plot (tiles with the color
representing the values in the assay), with gaps between
observations filled in by linear interpolation.}
}
If \code{NULL}, do not plot any read-level tracks.}

\item{tracks.summary}{A named list where the names correspond to assay names
of summarized data in \code{se} and the values are character vectors with
plot types to make for each assay. Currently supported plot types are:
\describe{
\item{\code{Point}}{: A point plot displaying values in the assay.}
\item{\code{Smooth}}{: A smoothed line plot displaying values in the
assay.}
\item{\code{PointSmooth}}{: A point and smoothed line plot displaying
values in the assay.}
}
If \code{NULL}, do not plot any summary data tracks.
A special case is the track name \code{"FracMod"}: If \code{se} does not
contain an assay of that name, but \code{"Nmod"} and \code{"Nvalid"}
assays are available, \code{"FracMod"} will be calculated from
\code{assay(se, "Nmod") / assay(se, "Nvalid")}.}

\item{modbaseSpace}{A logical scalar. If \code{TRUE}, the x-axis will be
shown in the space of modified bases and contain only the positions at
which there are modified bases in the data without any gaps between them.
If \code{FALSE}, the x-axis will show the genomic coordinate on which
the modified bases are typically irregularly spaced.}

\item{sequence.context}{A character vector with sequence context(s)
to plot. Only positions that match one of the provided sequence
contexts will be included in the plot. Sequence contexts can be provided
using IUPAC redundancy codes. The sequence contexts of modified bases are
obtained from \code{rowData(se)$sequence.context} and thus requires that
\code{se} contains the appropriate information, for example by setting
the \code{sequence.context} and \code{sequence.reference} arguments of
\code{\link{readBedMethyl}} when it was generated, or by adding it using
\code{\link{addSeqContext}}.}
}
\value{
A \code{\link[ggplot2]{ggplot}} object with tracks selected by
\code{tracks.reads} and \code{tracks.summary}.
}
\description{
This function will visualize read-level or collapsed single-molecule
footprinting data, such as data imported using \code{\link{readModkitExtract}}
or \code{\link{readBedMethyl}}.
}
\examples{
# summarized data (5mC)
bmfiles <- system.file("extdata",
                       c("modkit_pileup_1.bed.gz", "modkit_pileup_2.bed.gz"),
                       package = "footprintR")
reffile <- system.file("extdata", "reference.fa.gz", package = "footprintR")

seA <- readBedMethyl(bmfiles, modbase = "m",
                     sequence.context = 3, sequence.reference = reffile)

plotRegion(seA, region = "chr1:6940000-6955000", sequence.context = "GCH")
plotRegion(seA, region = "chr1:6940000-6955000", sequence.context = "HCG")

plotRegion(seA, region = "chr1:6940000-6955000",
           tracks.summary = list(Nvalid = "Smooth"))

# read-level data (6mA)
extractfiles <- system.file("extdata",
                            c("modkit_extract_rc_6mA_1.tsv.gz",
                              "modkit_extract_rc_6mA_2.tsv.gz"),
                            package = "footprintR")
seB <- readModkitExtract(extractfiles, modbase = "a", filter = "modkit")

# Lollipop plot
plotRegion(seB, region = "chr1:6935800-6935900",
           tracks.summary = NULL,
           tracks.reads = list(mod_prob = "Lollipop"))
# Heatmap plots (observed only or filled)
plotRegion(seB, region = "chr1:6935800-6935900",
           tracks.summary = NULL,
           tracks.reads = list(mod_prob = "Heatmap"))
plotRegion(seB, region = "chr1:6935800-6935900",
           tracks.summary = NULL,
           tracks.reads = list(mod_prob = "HeatmapFilled"))

# multiple plots
plotRegion(seB, region = "chr1:6935400-6935450",
           tracks.summary = NULL,
           tracks.reads = list(mod_prob = c("Lollipop", "Heatmap")),
           modbaseSpace = TRUE)

}
\seealso{
\code{\link{readModBam}}, \code{\link{readModkitExtract}} and
\code{\link{readBedMethyl}} for reading read-level and summarized
footprinting data.
}
\author{
Charlotte Soneson, Michael Stadler
}
