% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getReadDataForRegion.R
\name{getReadDataForRegion}
\alias{getReadDataForRegion}
\title{Get read-level data for a region from a modBAM file.}
\usage{
getReadDataForRegion(
  bamfile,
  region,
  arglist.modkitExtract = list(modkit_bin = "modkit"),
  arglist.readModkitExtract = list(),
  arglist.filterReadData = NULL,
  assay.type = "mod_prob",
  verbose = FALSE
)
}
\arguments{
\item{bamfile}{Character scalar with the name of a modBAM file (a BAM
file that stores modified-base data).}

\item{region}{A \code{\link[GenomicRanges]{GRanges}} object with a single
region for which data should be extracted from \code{bamfile}.
Alternatively, the region can be specified as a character scalar (e.g.
"chr1:1200-1300") that can be coerced into a \code{GRanges} object.}

\item{arglist.modkitExtract}{A named list with further argument to pass to
\code{\link{modkitExtract}} (must not contain \code{bamfile} or
\code{regions}, which are set automatically).}

\item{arglist.readModkitExtract}{A named list with further argument to pass to
\code{\link{readModkitExtract}} (must not contain \code{fnames}, which
is set automatically).}

\item{arglist.filterReadData}{A named list with further argument to pass to
\code{\link{filterReadData}}. Alternatively, it can be set to \code{NULL},
in which case no filtering will be performed.}

\item{assay.type}{A string scalar specifying the assay name to store
modification probabilities.}

\item{verbose}{If \code{TRUE}, report on progress.}
}
\value{
A \code{\link[SummarizedExperiment]{RangedSummarizedExperiment}} object
with positions of modified bases in rows and reads in the columns.
}
\description{
This function returns a \code{\link[SummarizedExperiment]{RangedSummarizedExperiment}}
object with read-level footprinting data extracted for a specific \code{region}
from a \code{bamfile} in modBAM format.
\code{getReadDataForRegion()} is a convenience wrapper around three other
functions that could also be called independently from one another:
\describe{
\item{\code{\link{modkitExtract}}}{runs \code{modkit} and extracts the
read-level base modification information from a modBAM file.}
\item{\code{\link{readModkitExtract}}}{reads the resulting output from
\code{modkit} into a \code{\link[SummarizedExperiment]{SummarizedExperiment}}
object.}
\item{\code{\link{filterReadData}}}{calculates quality measures
and optionally filters out data from low quality reads.}
}
}
\examples{
\dontrun{
modbamfile <- system.file("extdata", "6mA_1_10reads.bam", package = "footprintR")
se <- getReadDataForRegion(modbamfile,
                           region = "chr1:6940000-6955000",
                           arglist.readModkitExtract = list(modbase = "a"))
se
}

}
\seealso{
\code{\link[SummarizedExperiment]{SummarizedExperiment}} for the
returned object type, \code{\link{modkitExtract}} for calling
\code{modkit}, \code{\link{readModkitExtract}} for the function
used to read the \code{modkit} output and \code{\link{filterReadData}}
for filtering read-level footprinting data.
}
\author{
Michael Stadler
}
