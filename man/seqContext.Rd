% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seqContext.R
\name{seqContext}
\alias{seqContext}
\title{Extract the sequence context around positions of interest.}
\usage{
seqContext(x, sequence.context.width, sequence.reference)
}
\arguments{
\item{x}{A \code{\link[GenomicRanges]{GRanges}} object defining the regions
of interest. The extracted sequences will correspond to the regions
defined as \code{resize(x, width = sequence.context.width, fix = "center"}.}

\item{sequence.context.width}{A numeric scalar giving the width of the
sequence context to be extracted from the reference
(\code{sequence.reference} argument). This must be an odd number
so that the sequence can be centered on the modified base.
If \code{sequence.context.width = 0} (the default), no
sequence context will be extracted.}

\item{sequence.reference}{A \code{\link[BSgenome]{BSgenome}} object, or a
character scalar giving the path to a fasta formatted file with reference
sequences, or a \code{\link[Biostrings]{DNAStringSet}} object.
The sequence context (see \code{sequence.context.width} argument) will be
extracted from these sequences.}
}
\value{
A \code{\link[Biostrings]{DNAStringSet}} object of the same length
as \code{x} with extracted sequence context. All elements are guaranteed
to have identical length (if the sequence context extends to before the
start or beyond the end of a  reference sequence, it will be padded with
'N' bases.
}
\description{
This function will extract a sequence context of \code{sequence.context.width}
bases around the center of the regions defined in \code{x} from
\code{sequence.reference}.
}
\examples{
# file with sequence in fasta format of length 6957060
reffile <- system.file("extdata", "reference.fa.gz", package = "footprintR")

# define some regions at the end of the reference sequence
regions <- GenomicRanges::GRanges(
    "chr1", IRanges::IRanges(start = 6957060 - c(4, 2, 0),
    width = 1, names = c("a","b","c")))

# extract sequence context (note the padding with N's)
seqContext(regions, 7, reffile)

}
\seealso{
\code{\link[GenomicRanges]{resize}}, \code{\link[Biostrings]{DNAStringSet}}
}
\author{
Michael Stadler
}
