% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/readModkitExtract.R
\name{readModkitExtract}
\alias{readModkitExtract}
\title{Read modkit extract file(s)}
\usage{
readModkitExtract(
  fnames,
  modbase,
  filter = NULL,
  nrows = Inf,
  seqinfo = NULL,
  ncpu = 1L,
  verbose = FALSE
)
}
\arguments{
\item{fnames}{Character vector with one or several paths of \code{extract.tsv}
files, such as generated by \code{modkit}. If \code{fnames} is a named
vector, the names are used as prefixes for the column (read) names in
the returned \code{SummarizedExperiment} object. Otherwise, the prefixes
will be \code{s1}, ..., \code{sN}, where \code{N} is the length of
\code{fnames}.}

\item{modbase}{Character vector defining the modified base for each sample.
If \code{modbase} is a named vector, the names should correspond to
the names of \code{fnames}. Otherwise, it will be assumed that the
elements are in the same order as the files in \code{fnames}. If
\code{modbase} has length 1, the same modified base will be used for
all samples.}

\item{filter}{Either \code{NULL} (no filtering is performed),
\code{"modkit"} (only records where the \code{"fail"} column in the
extract file is \code{FALSE} are retained), or a named vector, providing
filter thresholds (on the call probability) for the
unmodified and modified bases, respectively. The names of the vector
should be \code{"-"} and the value(s) in \code{modbase}.}

\item{nrows}{Only read \code{nrows} rows of each input file.}

\item{seqinfo}{\code{NULL} or a \code{\link[GenomeInfoDb]{Seqinfo}} object
containing information about the set of genomic sequences (chromosomes).
Alternatively, a named numeric vector with genomic sequence names and
lengths. Useful to set the sorting order of sequence names.}

\item{ncpu}{A numeric scalar giving the number of parallel CPU threads to
to use for some of the steps in \code{readModkitExtract()}.}

\item{verbose}{If \code{TRUE}, report on progress.}
}
\value{
A \code{\link[SummarizedExperiment]{SummarizedExperiment}} object
with genomic positions in rows and samples in columns.
}
\description{
This function reads one or more modkit extract files and generates a
single SummarizedExperiment object with rows representing positions and
columns representing reads. The SummarizedExperiment object
contains one assay (\code{mod_prob}) with modification probabilities for
each position in each read. Unobserved read/position combinations are
represented by a zero, while all values that are 'implicitly' called by
modkit (with a modification probability less than 5\%) are represented with
a value of 0.02.
}
\examples{
extrfile <- system.file("extdata", "modkit_extract_rc_5mC_1.tsv.gz",
                        package = "footprintR")
## ... no filtering
readModkitExtract(extrfile, modbase = "m", filter = NULL)
## ... modkit filtering
readModkitExtract(extrfile, modbase = "m", filter = "modkit")

}
\seealso{
\href{https://nanoporetech.github.io/modkit}{\code{modkit} software},
\code{\link[SummarizedExperiment]{SummarizedExperiment}} for the returned object type,
\code{\link[data.table]{fread}} for the function used to read the input files
}
\author{
Charlotte Soneson
}
