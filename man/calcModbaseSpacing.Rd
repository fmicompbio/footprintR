% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/modbase_spacing.R
\name{calcModbaseSpacing}
\alias{calcModbaseSpacing}
\title{Calculate distances between modified bases on individual reads.}
\usage{
calcModbaseSpacing(
  se,
  assay.type = "mod_prob",
  min_mod_prob = 0.5,
  rmdup = TRUE,
  dmax = 1000L
)
}
\arguments{
\item{se}{\code{\link[SummarizedExperiment]{SummarizedExperiment}} object
with read-level footprinting data, for example returned by
\code{\link{readModBam}}. Rows should correspond to positions
and columns to samples.}

\item{assay.type}{A string or integer scalar specifying the assay of
\code{se} containing the read-level modification probabilities.}

\item{min_mod_prob}{Numeric scalar giving the minimal modification
probability for a modified base.}

\item{rmdup}{Logical scalar indicating if duplicates should be removed.
If \code{TRUE} (the default), only one of several alignments starting at
the same coordinate is used.}

\item{dmax}{Numeric scalar specifying the maximal distance between
modified bases on the same read to count.}
}
\value{
A named list of length \code{ncol(se)} (one element for each sample).
The elements are \code{integer} vectors of length \code{dmax}, with the
value at position \code{d} giving the observed number of within-read
modified bases at distance \code{d}.
}
\description{
Calculate the frequencies of same-read modified base distances,
for example from read-level modification data to estimate nucleosome
repeat length. Distances are calculated separately for each sample
(column in \code{se}), but if needed they can be easily combined for
estimating NRL on a pool of samples by summing up observed counts
(e.g. using \code{Reduce("+", sampleDistsList)}. Distance calculations
are implemented in C++ (\code{\link{calcAndCountDist}}) for efficiency.
}
\examples{
modbamfiles <- system.file("extdata",
                           c("6mA_1_10reads.bam", "6mA_2_10reads.bam"),
                           package = "footprintR")
se <- readModBam(modbamfiles, "chr1:6940000-6955000", "a")

# get distances for each sample
moddist <- calcModbaseSpacing(se)

# analyze NRL for sample 's1'
print(estimateNRL(moddist$s1)[1:2])
plotModbaseSpacing(moddist$s1)
plotModbaseSpacing(moddist$s1, detailedPlots = TRUE)

# combine samples
moddistComb <- Reduce("+", moddist)
print(estimateNRL(moddistComb)[1:2])

}
\references{
Phasograms were originally described in Valouev et al., Nature
2011 (doi:10.1038/nature10002). The implementation here differs in three
ways from the original algorithms:
\enumerate{
\item Instead of same strand alignment start positions, this function
is adapted to single-molecule footprinting data and measures
the distances between same-read modified base positions.
\item It does not implement removing of positions that have been seen
less than \code{n} times (referred to as a \code{n}-pile subset in
the paper).
\item It does allow to retain only alignments that fall into selected
genomic intervals (\code{regions} argument).
}
}
\seealso{
\code{\link{estimateNRL}} to estimate the nucleosome repeat length
from a phasogram, \code{\link{plotModbaseSpacing}} to visualize an annotated
phasogram, \code{\link{calcAndCountDist}} for low-level distance counting.
}
\author{
Michael Stadler
}
