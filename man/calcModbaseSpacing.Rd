% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/modbase_spacing.R
\name{calcModbaseSpacing}
\alias{calcModbaseSpacing}
\title{Calculate distances between modified bases on individual reads.}
\usage{
calcModbaseSpacing(
  bamfiles,
  regions,
  modbase,
  min_mod_prob = 0.5,
  rmdup = TRUE,
  dmax = 1000L
)
}
\arguments{
\item{bamfiles}{Character vector with one or several bam files. If
multiple files are given, distance counts from all will be summed.}

\item{regions}{A \code{\link[GenomicRanges]{GRanges}} object specifying which
genomic regions to extract the reads from. Alternatively, regions can be
specified as a character vector (e.g. "chr1:1200-1300") that can be
coerced into a \code{GRanges} object. Note that the reads are not
trimmed to the boundaries of the specified ranges. As a result, analyzed
positions will typically extend out of the specified regions.}

\item{modbase}{Character scalar defining the modified base.}

\item{min_mod_prob}{Numeric scalar giving the minimal modification
probability for a modified base.}

\item{rmdup}{Logical scalar indicating if duplicates should be removed.
If \code{TRUE} (the default), only one of several alignments starting at
the same coordinate is used.}

\item{dmax}{Numeric scalar specifying the maximal distance between
modified bases on the same read to count.}
}
\value{
\code{integer} vector with \code{dmax} elements, with the element at
position \code{d} giving the observed number of alignment pairs at that
distance.
}
\description{
Calculate the frequencies of same read modified base distances,
for example from read-level modification data to estimate nucleosome
repeat length. Distance calculations are implemented in C++
(\code{\link{calcAndCountDist}}) for efficiency.
}
\examples{
modbamfiles <- system.file("extdata",
                           c("6mA_1_10reads.bam", "6mA_2_10reads.bam"),
                           package = "footprintR")
pg <- calcModbaseSpacing(modbamfiles, "chr1:6940000-6955000", "a")
print(estimateNRL(pg)[1:2])
plotModbaseSpacing(pg)
plotModbaseSpacing(pg, detailedPlots = TRUE)

}
\references{
Phasograms were originally described in Valouev et al., Nature
2011 (doi:10.1038/nature10002). The implementation here differs in three
ways from the original algorithms:
\enumerate{
\item Instead of same strand alignment start positions, this function
studies the same read modified base positions.
\item It does not implement removing of positions that have been seen
less than \code{n} times (referred to as a \code{n}-pile subset in
the paper).
\item It does allow to retain only alignments that fall into selected
genomic intervals (\code{regions} argument).
}
}
\seealso{
\code{\link{estimateNRL}} to estimate the nucleosome repeat length
from a phasogram, \code{\link{plotModbaseSpacing}} to visualize an annotated
phasogram, \code{\link{calcAndCountDist}} for low-level distance counting.
}
\author{
Michael Stadler
}
