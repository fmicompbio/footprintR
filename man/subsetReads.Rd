% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/subsetReads.R
\name{subsetReads}
\alias{subsetReads}
\title{Subset the reads from read-level assays.}
\usage{
subsetReads(se, reads, prune = TRUE, invert = FALSE)
}
\arguments{
\item{se}{A \code{\link[SummarizedExperiment]{RangedSummarizedExperiment}},
typically generated by \code{\link{readModBam}} or
\code{\link{readModkitExtract}}.}

\item{reads}{Defines reads to retain (or remove, if \code{invert=TRUE}).
Either a character vector of read identifiers, or a named list in which
names are samples from \code{colnames(se)} and the elements are
index vectors (character, integer or logical) defining the reads for
each sample.}

\item{prune}{A logical scalar. If \code{TRUE} (the default), samples for
which the subsetting retains none of the reads will be completely removed
from the returned \code{SummarizedExperiment} (also from \code{colData}
and from assays that do not store read-level data). If \code{FALSE},
such samples are retained (in the assays with read-level data as a
zero-column \code{SparseMatrix}).}

\item{invert}{A logical scalar. If \code{FALSE} (the default), only the reads
defined by \code{reads} are retained. If \code{invert=TRUE}, all reads
except the ones in \code{reads} are retained.}
}
\value{
A subset \code{\link[SummarizedExperiment]{RangedSummarizedExperiment}}
object.
}
\description{
This function takes read names or indices and subsets them from the
specified assays of \code{\link[SummarizedExperiment]{RangedSummarizedExperiment}}
with read-level data. While subsetting of samples (the columns of the
SummarizedExperiment object) can be done easily (e.g. \code{se[, 1]}),
the reads are grouped by sample in read-level assays, and this function
provides a more convenient way to subset these nested reads.
}
\examples{
modbamfiles <- system.file("extdata",
                           c("6mA_1_10reads.bam", "6mA_2_10reads.bam"),
                           package = "footprintR")
se <- readModBam(modbamfiles, "chr1:6940000-6955000", "a")
lapply(assay(se, "mod_prob"), colnames)

# subset by read identifiers
seSub <- subsetReads(se, c("s1-233e48a7-f379-4dcf-9270-958231125563",
                           "s2-034b625e-6230-4f8d-a713-3a32cd96c298"))
lapply(assay(seSub, "mod_prob"), colnames)

# subset by a list of indices
seSub <- subsetReads(se, list(s1 = c(1, 3),
                              s2 = c(TRUE, FALSE)))
lapply(assay(seSub, "mod_prob"), colnames)

}
\author{
Michael Stadler
}
