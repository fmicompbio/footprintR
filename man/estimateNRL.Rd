% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/modbase_spacing.R
\name{estimateNRL}
\alias{estimateNRL}
\title{Estimate the nucleosome repeat length (NRL) from modified-base distances.}
\usage{
estimateNRL(
  x,
  mind = 140L,
  usePeaks = 1:5,
  span1 = 100/length(x),
  span2 = 1500/length(x)
)
}
\arguments{
\item{x}{\code{numeric} vector giving the counts of distances
(typically the output of \code{\link{calcModbaseSpacing}}.}

\item{mind}{\code{integer(1)} specifying the minimal distance to be used for
NRL estimation. The default value (140) ignores any distance too short to
span at least a single nucleosome.}

\item{usePeaks}{\code{integer} vector selecting the modes (peaks) in the
phasogram used in NRL estimation.}

\item{span1}{\code{numeric(1)} giving the smoothing parameter for de-trending
loess fit (high pass filter).}

\item{span2}{\code{numeric(1)} giving the smoothing parameter for de-noising
loess fit (low pass filter).}
}
\value{
A \code{list} with elements:
\describe{
\item{nrl}{the estimated nucleosome repeat length}
\item{nrl.CI95}{the 95-percent confidence interval}
\item{xs}{smoothed (de-trended) phasogram}
\item{loessfit}{the de-noising fit to the de-trended phasogram}
\item{lmfit}{the linear fit to the phasogram peaks}
\item{mind}{minimal distance included in the fit}
\item{span1}{smoothing parameter for de-trending loess fit}
\item{span2}{smoothing parameter for de-noising loess fit}
\item{usePeaks}{the peaks used in the fit}
}
}
\description{
Estimate the nucleosome repeat length (NRL) from the frequencies
of same-read modified base distances, e.g. generated by
\code{\link{calcModbaseSpacing}}. The NRL is obtained from the slope of a
linear fit to the modes in the distance distribution.
}
\examples{
  # see the help for calcModbaseSpacing() for a full example

}
\seealso{
\code{\link{calcModbaseSpacing}} to calculate the distances from
base modification data, \code{\link{plotModbaseSpacing}} to visualize
annotated distance frequencies between modified bases.
}
\author{
Michael Stadler
}
