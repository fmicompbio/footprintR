% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/readModBam.R
\name{readModBam}
\alias{readModBam}
\title{Read base modifications from a bam file.}
\usage{
readModBam(
  bamfiles,
  regions,
  modbase,
  seqinfo = NULL,
  ncpu = 1L,
  verbose = FALSE
)
}
\arguments{
\item{bamfiles}{Character vector with one or several paths of \code{modBAM}
files, containing information about base modifications in \code{MM} and
\code{ML} tags. If \code{bamfiles} is a named vector, the names are used
as sample names and prefixes for read names. Otherwise, the prefixes will
be \code{s1}, ..., \code{sN}, where \code{N} is the length of
\code{bamfiles}. All \code{bamfiles} must have an index.}

\item{regions}{A \code{\link[GenomicRanges]{GRanges}} object specifying which
genomic regions to extract the reads from. Alternatively, regions can be
specified as a character vector (e.g. "chr1:1200-1300") that can be
coerced into a \code{GRanges} object. Note that the reads are not
trimmed to the boundaries of the specified ranges. As a result, returned
positions will typically extend out of the specified regions.}

\item{modbase}{Character vector defining the modified base for each sample.
If \code{modbase} is a named vector, the names should correspond to
the names of \code{bamfiles}. Otherwise, it will be assumed that the
elements are in the same order as the files in \code{bamfiles}. If
\code{modbase} has length 1, the same modified base will be used for
all samples.}

\item{seqinfo}{\code{NULL} or a \code{\link[GenomeInfoDb]{Seqinfo}} object
containing information about the set of genomic sequences (chromosomes).
Alternatively, a named numeric vector with genomic sequence names and
lengths. Useful to set the sorting order of sequence names.}

\item{ncpu}{A numeric scalar giving the number of parallel CPU threads to
to use for some of the steps in \code{readModBam}.}

\item{verbose}{Logical scalar. If \code{TRUE}, report on progress.}
}
\value{
A \code{\link[SummarizedExperiment]{SummarizedExperiment}} object
with genomic positions in rows and samples in columns. The assay
\code{"mod_prob"} contains per-read modification probabilities,
with each column (sample) corresponding to a position-by-read
\code{\link[SparseArray]{SparseMatrix}}.
}
\description{
Parse ML and MM tags (see https://samtools.github.io/hts-specs/SAMtags.pdf,
section 1.7) and return a \code{\link[SummarizedExperiment]{SummarizedExperiment}}
object with information on modified bases.
}
\examples{
modbamfile <- system.file("extdata", "6mA_1_10reads.bam",
                          package = "footprintR")
readModBam(bamfiles = modbamfile, regions = "chr1:6940000-6955000",
           modbase = "a", verbose = TRUE)

}
\seealso{
https://samtools.github.io/hts-specs/SAMtags.pdf describing the
SAM ML and MM tags for base modifications.
}
\author{
Michael Stadler
}
