% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/modkitExtract.R
\name{modkitExtract}
\alias{modkitExtract}
\title{Call \verb{modkit extract} to extract read-level base modifications from modBAM files}
\usage{
modkitExtract(
  modkit_bin = "",
  bamfile = "",
  regions = NULL,
  num_reads = NULL,
  out_extract_table = NULL,
  out_read_calls = NULL,
  out_log_file = NULL,
  modkit_args = NULL,
  tempdir_base = tempdir()
)
}
\arguments{
\item{modkit_bin}{Character scalar specifying the path to the \code{modkit}
binary.}

\item{bamfile}{Character scalar specifying the path to a \code{modBAM}
file. An indexed BAM file can significantly speed up certain extract
operations.}

\item{regions}{A \code{\link[GenomicRanges]{GRanges}} object specifying which
genomic regions to extract the reads from. Note that the reads are not
trimmed to the boundaries of the specified ranges. As a result, returned
positions will typically extend out of the specified regions.}

\item{num_reads}{Number of reads to extract per specified genomic region.
When \code{N} genomic ranges are specified, the total number of extracted
reads will be at most \code{num_reads * N}.}

\item{out_extract_table}{Character scalar specifying the path for the
\verb{extract table} output. Can be \code{NULL} if only a \code{read-calls}
table is needed.}

\item{out_read_calls}{Character scalar specifying the path for the
\verb{read-calls table} output. Can be \code{NULL} if only an \verb{extract table}
is needed.}

\item{out_log_file}{Character scalar specifying the path for the the command
run log output. Can be \code{NULL} if no log file is needed (not
recommended).}

\item{modkit_args}{Character vector with additional \verb{modkit extract}
arguments. Please refer to the \verb{modkit extract} documentation for a
complete list of possible arguments.}

\item{tempdir_base}{Character scalar specifying the path to create the
\code{modkit_temp} directory. This temporary directory is only created when
multiple genomic regions are specified.}
}
\value{
A character vector with the elements "extract-table", "read-calls"
and "run-log", specifying the paths to the generated table, call and log
files, respectively. An \code{NA} value indicates that a given output
was not generated.
}
\description{
This function is a wrapper around the \verb{modkit extract} sub-command to extract
read-level base modification information from modBAM files into tab-separated
values table(s).
For more information on available \verb{modkit extract} arguments and output
tables specification see https://nanoporetech.github.io/modkit/intro_extract.html
}
\examples{
\dontrun{
GR <- as(c("chr1:12340678-12345678", "chr2:12340678-12345678"), "GRanges")

further_args <- c(
   '-t 8', '--force',
   '--mapped-only', '--edge-filter 100',
   '-p  0.2',
   '--mod-threshold m:0.8',
   '--mod-threshold a:0.5'
)

# Produce both `extract table` and `read calls` files for multiple GRanges
modkitExtract(modkit = modkit_bin_PATH, bamfile = BAMF, num_reads = 10,
              regions = GR[1:2], out_extract_table = "test.etbl",
              out_read_calls = "test.rdcl", modkit_args = further_args)
# Produce only `extract table` file
modkitExtract(modkit = modkit_bin_PATH, bamfile = BAMF, num_reads = 10,
              regions = GR[1], out_extract_table = "test.etbl",
              out_read_calls = NULL, modkit_args = further_args)
# Produce only `read calls` file
modkitExtract(modkit = modkit_bin_PATH, bamfile = BAMF, num_reads = 10,
              regions = GR[1], out_extract_table = NULL,
              out_read_calls = "test.rdcl", modkit_args = further_args)
}

}
\seealso{
\href{https://nanoporetech.github.io/modkit}{\code{modkit} software},
\href{https://nanoporetech.github.io/modkit/intro_extract.html}{\verb{modkit extract} documentation and tabulated output formats specification},
\code{\link[GenomicRanges]{GRanges}} for the object used to specify
genomic regions.
}
\author{
Panagiotis Papapasaikas
}
