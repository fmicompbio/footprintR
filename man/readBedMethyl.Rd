% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/readBedMethyl.R
\name{readBedMethyl}
\alias{readBedMethyl}
\title{Read collapsed single-molecule footprinting data from a \code{bedMethyl} file.}
\usage{
readBedMethyl(
  fnames,
  modbase,
  nrows = Inf,
  seqinfo = NULL,
  sequence.context.width = 0,
  sequence.reference = NULL,
  ncpu = 1L,
  verbose = FALSE
)
}
\arguments{
\item{fnames}{Character vector with one or several paths of \code{bedMethyl}
files, such as generated by \code{modkit pileup}. Each file will be read
separately and become one of the columns in the returned
\code{\link[SummarizedExperiment]{SummarizedExperiment}} object.
If \code{fnames} is a named vector, the names are used as column names in
the returned object. Otherwise, the column names will be \code{s1}, ...,
\code{sN}, where \code{N} is the length of \code{fnames}.
If several elements of \code{fnames} have identical
names, the data from the corresponding files are summed into a single
column in the returned object.}

\item{modbase}{Character vector defining the modified base for each sample.
If \code{modbase} is a named vector, the names should correspond to
the names of \code{fnames}. Otherwise, it will be assumed that the
elements are in the same order as the files in \code{fnames}. If
\code{modbase} has length 1, the same modified base will be used for
all samples.}

\item{nrows}{Only read \code{nrows} rows of the input file.}

\item{seqinfo}{\code{NULL} or a \code{\link[GenomeInfoDb]{Seqinfo}} object
containing information about the set of genomic sequences (chromosomes).
Alternatively, a named numeric vector with genomic sequence names and
lengths. Useful to set the sorting order of sequence names.}

\item{sequence.context.width, sequence.reference}{Define the sequence
context to be extracted around modified bases. By default (
\code{sequence.context.width = 0}), no sequence context will be
extracted, otherwise it will be returned in \code{rowData(x)$sequence.context}.
See \code{\link{addSeqContext}} for details.}

\item{ncpu}{A numeric scalar giving the number of parallel CPU threads to
to use for some of the steps in \code{readBedMethyl()}.}

\item{verbose}{If \code{TRUE}, report on progress.}
}
\value{
A \code{\link[SummarizedExperiment]{SummarizedExperiment}} object
with genomic positions in rows and samples (the unique names of
\code{fnames}) in the columns. If \code{sequence.context.width != 0},
\code{rowData(x)$sequence.context} will be a \code{\link[Biostrings]{DNAStringSet}}
object with the extracted sequences.
}
\description{
This function will read collapsed single-molecule footprinting data
(reads combined per genomic position) from a \code{bedMethyl} file.
}
\examples{
bmfile <- system.file("extdata", "modkit_pileup_1.bed.gz", package = "footprintR")
readBedMethyl(bmfile, modbase = "m")

}
\seealso{
\href{https://nanoporetech.github.io/modkit}{\code{modkit} software},
\href{https://nanoporetech.github.io/modkit/intro_bedmethyl.html#description-of-bedmethyl-output}{\code{bedMethyl} format description},
\code{\link[SummarizedExperiment]{SummarizedExperiment}} for the returned object type,
\code{\link[data.table]{fread}} for the function used to read the input files,
\code{\link{addSeqContext}} used to add the sequence context.
}
\author{
Michael Stadler
}
