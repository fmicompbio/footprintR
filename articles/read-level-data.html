<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exploring read-level footprinting data with `footprintR` • footprintR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exploring read-level footprinting data with `footprintR`">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">footprintR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/read-level-data.html">Exploring read-level footprinting data with `footprintR`</a>
    </li>
    <li>
      <a href="../articles/using-footprintR.html">Using `footprintR`</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fmicompbio/footprintR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Exploring read-level footprinting data with
<code>footprintR</code>
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fmicompbio/footprintR/blob/devel/vignettes/read-level-data.Rmd" class="external-link"><code>vignettes/read-level-data.Rmd</code></a></small>
      <div class="hidden name"><code>read-level-data.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p>We start the analysis by loading footprinting data at the level of
individual reads. Such data is typically generated by <a href="https://nanoporetech.github.io/modkit" class="external-link">modkit</a> from
<code>modBam</code> files (see also <code><a href="../reference/modkitExtract.html">?modkitExtract</a></code> for a
wrapper function to do this directly from R) and then read using
<code><a href="../reference/readModkitExtract.html">readModkitExtract()</a></code>.</p>
<p>The <code>footprintR</code> package contains small example files that
were generated by ‘modkit extract’:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fmicompbio/footprintR" class="external-link">footprintR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read-level 6mA data generated by 'modkit extract'</span></span>
<span><span class="va">extractfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modkit_extract_rc_6mA_1.tsv.gz"</span>,</span>
<span>                              <span class="st">"modkit_extract_rc_6mA_2.tsv.gz"</span><span class="op">)</span>,</span>
<span>                            package <span class="op">=</span> <span class="st">"footprintR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">extractfiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample1"</span>, <span class="st">"sample2"</span><span class="op">)</span></span></code></pre></div>
<p>These files can be read using <code><a href="../reference/readModkitExtract.html">readModkitExtract()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readModkitExtract.html">readModkitExtract</a></span><span class="op">(</span><span class="va">extractfiles</span>, </span>
<span>                        modbase <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>                        filter <span class="op">=</span> <span class="st">"modkit"</span><span class="op">)</span></span>
<span><span class="va">se</span></span>
<span><span class="co">#&gt; class: RangedSummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 8539 20 </span></span>
<span><span class="co">#&gt; metadata(2): modkit_threshold filter_threshold</span></span>
<span><span class="co">#&gt; assays(1): mod_prob</span></span>
<span><span class="co">#&gt; rownames(8539): chr1:6929104:+ chr1:6929106:+ ... chr1:6941530:-</span></span>
<span><span class="co">#&gt;   chr1:6941531:-</span></span>
<span><span class="co">#&gt; rowData names(0):</span></span>
<span><span class="co">#&gt; colnames(20): sample1-233e48a7-f379-4dcf-9270-958231125563</span></span>
<span><span class="co">#&gt;   sample1-d52a5f6a-a60a-4f85-913e-eada84bfbfb9 ...</span></span>
<span><span class="co">#&gt;   sample2-7fc51790-2c6e-49e9-938c-985850ff85e7</span></span>
<span><span class="co">#&gt;   sample2-573752c9-f768-46ff-9887-be555db141dc</span></span>
<span><span class="co">#&gt; colData names(1): sample</span></span></code></pre></div>
<p>This will create a <code>RangedSummarizedExperiment</code> object
with positions in rows and individual reads in columns:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># rows are positions...</span></span>
<span><span class="fu">rowRanges</span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span>
<span><span class="co">#&gt; UnstitchedGPos object with 8539 positions and 0 metadata columns:</span></span>
<span><span class="co">#&gt;                  seqnames       pos strand</span></span>
<span><span class="co">#&gt;                     &lt;Rle&gt; &lt;integer&gt;  &lt;Rle&gt;</span></span>
<span><span class="co">#&gt;   chr1:6929104:+     chr1   6929104      +</span></span>
<span><span class="co">#&gt;   chr1:6929106:+     chr1   6929106      +</span></span>
<span><span class="co">#&gt;   chr1:6929111:+     chr1   6929111      +</span></span>
<span><span class="co">#&gt;   chr1:6929113:+     chr1   6929113      +</span></span>
<span><span class="co">#&gt;   chr1:6929118:+     chr1   6929118      +</span></span>
<span><span class="co">#&gt;              ...      ...       ...    ...</span></span>
<span><span class="co">#&gt;   chr1:6941513:-     chr1   6941513      -</span></span>
<span><span class="co">#&gt;   chr1:6941522:-     chr1   6941522      -</span></span>
<span><span class="co">#&gt;   chr1:6941524:-     chr1   6941524      -</span></span>
<span><span class="co">#&gt;   chr1:6941530:-     chr1   6941530      -</span></span>
<span><span class="co">#&gt;   chr1:6941531:-     chr1   6941531      -</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></span>
<span></span>
<span><span class="co"># ... and columns are reads</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 20 rows and 1 column</span></span>
<span><span class="co">#&gt;                                                   sample</span></span>
<span><span class="co">#&gt;                                              &lt;character&gt;</span></span>
<span><span class="co">#&gt; sample1-233e48a7-f379-4dcf-9270-958231125563     sample1</span></span>
<span><span class="co">#&gt; sample1-d52a5f6a-a60a-4f85-913e-eada84bfbfb9     sample1</span></span>
<span><span class="co">#&gt; sample1-fc4646ce-66f9-401f-b968-e9b0cda14d61     sample1</span></span>
<span><span class="co">#&gt; sample1-92e906ae-cddb-4347-a114-bf9137761a8d     sample1</span></span>
<span><span class="co">#&gt; sample1-6cf74134-e550-4c02-bd2b-91385422ee25     sample1</span></span>
<span><span class="co">#&gt; ...                                                  ...</span></span>
<span><span class="co">#&gt; sample2-d03efe3b-a45b-430b-9cb6-7e5882e4faf8     sample2</span></span>
<span><span class="co">#&gt; sample2-04784c5b-e31b-421f-a14c-7072ec62b50d     sample2</span></span>
<span><span class="co">#&gt; sample2-9c27e4b2-d929-494a-8878-60c8fca73bf1     sample2</span></span>
<span><span class="co">#&gt; sample2-7fc51790-2c6e-49e9-938c-985850ff85e7     sample2</span></span>
<span><span class="co">#&gt; sample2-573752c9-f768-46ff-9887-be555db141dc     sample2</span></span></code></pre></div>
<p>As you can see in the <code>colData(se)</code>, reads are assigned to
samples. The sample names are obtained from the input files (here
<code>extractfiles</code>), or if the files are not names will be
automatically assigned (each file corresponding to a separate
sample).</p>
</div>
<div class="section level2">
<h2 id="explore-assay-data">Explore assay data<a class="anchor" aria-label="anchor" href="#explore-assay-data"></a>
</h2>
<p>The single assay <code>mod_prob</code> is a <code>SparseMatrix</code>
with modification probabilities.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assayNames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "mod_prob"</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">se</span>, <span class="st">"mod_prob"</span><span class="op">)</span></span>
<span><span class="va">m</span></span>
<span><span class="co">#&gt; &lt;8539 x 20 SparseMatrix&gt; of type "double" [nzcount=47990 (28%)]:</span></span>
<span><span class="co">#&gt;                sample1-233e48a7-f379-4dcf-9270-958231125563 ...</span></span>
<span><span class="co">#&gt; chr1:6929104:+                                            0   .</span></span>
<span><span class="co">#&gt; chr1:6929106:+                                            0   .</span></span>
<span><span class="co">#&gt; chr1:6929111:+                                            0   .</span></span>
<span><span class="co">#&gt; chr1:6929113:+                                            0   .</span></span>
<span><span class="co">#&gt; chr1:6929118:+                                            0   .</span></span>
<span><span class="co">#&gt;            ...                                            .   .</span></span>
<span><span class="co">#&gt; chr1:6941513:-                                            0   .</span></span>
<span><span class="co">#&gt; chr1:6941522:-                                            0   .</span></span>
<span><span class="co">#&gt; chr1:6941524:-                                            0   .</span></span>
<span><span class="co">#&gt; chr1:6941530:-                                            0   .</span></span>
<span><span class="co">#&gt; chr1:6941531:-                                            0   .</span></span>
<span><span class="co">#&gt;                sample2-573752c9-f768-46ff-9887-be555db141dc</span></span>
<span><span class="co">#&gt; chr1:6929104:+                                            0</span></span>
<span><span class="co">#&gt; chr1:6929106:+                                            0</span></span>
<span><span class="co">#&gt; chr1:6929111:+                                            0</span></span>
<span><span class="co">#&gt; chr1:6929113:+                                            0</span></span>
<span><span class="co">#&gt; chr1:6929118:+                                            0</span></span>
<span><span class="co">#&gt;            ...                                            .</span></span>
<span><span class="co">#&gt; chr1:6941513:-                                            0</span></span>
<span><span class="co">#&gt; chr1:6941522:-                                            0</span></span>
<span><span class="co">#&gt; chr1:6941524:-                                            0</span></span>
<span><span class="co">#&gt; chr1:6941530:-                                            0</span></span>
<span><span class="co">#&gt; chr1:6941531:-                                            0</span></span></code></pre></div>
<p>This matrix does not store the zeros and thus uses much less memory
compared to a normal (dense) matrix. However, you have to be careful
when interpreting the values in that matrix, as they follow a specific
convention:</p>
<p><strong>Important: </strong> The zeros correspond to unobserved
read/position combinations, while all values that are ‘implicitly’
called by modkit (with a modifictation probability of less than 5%) are
represented with a value of 0.02.</p>
<p>That means if you would be manually calculating for example the
average modification probability at a given position, taking the row
mean would not be correct, as it would include the zero values that
correspond to unobserved data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># modification probabilities at position chr1:6933269:+</span></span>
<span><span class="va">m</span><span class="op">[</span><span class="st">"chr1:6933269:+"</span>, <span class="op">]</span></span>
<span><span class="co">#&gt; sample1-233e48a7-f379-4dcf-9270-958231125563 </span></span>
<span><span class="co">#&gt;                                    0.0000000 </span></span>
<span><span class="co">#&gt; sample1-d52a5f6a-a60a-4f85-913e-eada84bfbfb9 </span></span>
<span><span class="co">#&gt;                                    0.0000000 </span></span>
<span><span class="co">#&gt; sample1-fc4646ce-66f9-401f-b968-e9b0cda14d61 </span></span>
<span><span class="co">#&gt;                                    0.9082031 </span></span>
<span><span class="co">#&gt; sample1-92e906ae-cddb-4347-a114-bf9137761a8d </span></span>
<span><span class="co">#&gt;                                    0.0000000 </span></span>
<span><span class="co">#&gt; sample1-6cf74134-e550-4c02-bd2b-91385422ee25 </span></span>
<span><span class="co">#&gt;                                    0.8535156 </span></span>
<span><span class="co">#&gt; sample1-5d45d8d2-d5f5-47ff-a9fa-f3fd6b7bd3c7 </span></span>
<span><span class="co">#&gt;                                    0.7714844 </span></span>
<span><span class="co">#&gt; sample1-b6fea9db-c92d-4152-9d29-4d021bbc45e8 </span></span>
<span><span class="co">#&gt;                                    0.0000000 </span></span>
<span><span class="co">#&gt; sample1-49c1e21e-8cb0-415a-aba9-92912219c4bb </span></span>
<span><span class="co">#&gt;                                    0.6074219 </span></span>
<span><span class="co">#&gt; sample1-b0b20f04-931f-4f60-b3e4-0ee1f5666a61 </span></span>
<span><span class="co">#&gt;                                    0.9902344 </span></span>
<span><span class="co">#&gt; sample1-41ca0e97-11b3-454b-9741-bc373e29ef37 </span></span>
<span><span class="co">#&gt;                                    0.0000000 </span></span>
<span><span class="co">#&gt; sample2-daac487b-5406-42b5-b882-9020f1b03752 </span></span>
<span><span class="co">#&gt;                                    0.0000000 </span></span>
<span><span class="co">#&gt; sample2-034b625e-6230-4f8d-a713-3a32cd96c298 </span></span>
<span><span class="co">#&gt;                                    0.0000000 </span></span>
<span><span class="co">#&gt; sample2-274d50aa-f060-4bcf-901e-4cab771295f6 </span></span>
<span><span class="co">#&gt;                                    0.0000000 </span></span>
<span><span class="co">#&gt; sample2-3bee7d0d-d4cd-4b38-9839-10e1a0fce5de </span></span>
<span><span class="co">#&gt;                                    0.8300781 </span></span>
<span><span class="co">#&gt; sample2-c0f0cdaa-216c-4c8a-8a2a-7e5c1e8445f5 </span></span>
<span><span class="co">#&gt;                                    0.0000000 </span></span>
<span><span class="co">#&gt; sample2-d03efe3b-a45b-430b-9cb6-7e5882e4faf8 </span></span>
<span><span class="co">#&gt;                                    0.8574219 </span></span>
<span><span class="co">#&gt; sample2-04784c5b-e31b-421f-a14c-7072ec62b50d </span></span>
<span><span class="co">#&gt;                                    0.6816406 </span></span>
<span><span class="co">#&gt; sample2-9c27e4b2-d929-494a-8878-60c8fca73bf1 </span></span>
<span><span class="co">#&gt;                                    0.9667969 </span></span>
<span><span class="co">#&gt; sample2-7fc51790-2c6e-49e9-938c-985850ff85e7 </span></span>
<span><span class="co">#&gt;                                    0.0000000 </span></span>
<span><span class="co">#&gt; sample2-573752c9-f768-46ff-9887-be555db141dc </span></span>
<span><span class="co">#&gt;                                    0.0000000</span></span>
<span></span>
<span><span class="co"># WRONG: take the mean of all values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">m</span><span class="op">[</span><span class="st">"chr1:6933269:+"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3733398</span></span>
<span></span>
<span><span class="co"># CORRECT: exclude the zeros</span></span>
<span><span class="va">non_zero</span> <span class="op">&lt;-</span> <span class="va">m</span><span class="op">[</span><span class="st">"chr1:6933269:+"</span>, <span class="op">]</span> <span class="op">!=</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">m</span><span class="op">[</span><span class="st">"chr1:6933269:+"</span>, <span class="va">non_zero</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8296441</span></span></code></pre></div>
<p>This is however rarely needed, as there are convenience functions
that will exclude the unobserved (zero) values automatically for you.
For example, you can summarize the reads in each sample using
<code><a href="../reference/summarizeOverReads.html">summarizeOverReads()</a></code> (see next section).</p>
</div>
<div class="section level2">
<h2 id="summarize-read-level-data">Summarize read-level data<a class="anchor" aria-label="anchor" href="#summarize-read-level-data"></a>
</h2>
<p>Summarized data can be obtained from the read-level data by
calculating a summary on the reads from each sample:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summarizeOverReads.html">summarizeOverReads</a></span><span class="op">(</span><span class="va">se</span>, keep.reads <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nmod"</span>, <span class="st">"Nvalid"</span>, <span class="st">"FracMod"</span>, <span class="st">"Pmod"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>As discussed above, this will automatically exclude the non-observed
(zero) values from the data when calculating the modification
probability at each position (<code>Pmod</code> assay):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">se_summary</span>, <span class="st">"Pmod"</span><span class="op">)</span><span class="op">[</span><span class="st">"chr1:6933269:+"</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;   sample1   sample2 </span></span>
<span><span class="co">#&gt; 0.8261719 0.8339844</span></span></code></pre></div>
<p>The summary statistics to calculate are selected using the
<code>statistics</code> argument. By default,
<code><a href="../reference/summarizeOverReads.html">summarizeOverReads()</a></code> will count the number of modified
(<code>Nmod</code>) and total (<code>Nvalid</code>) reads at each
position and sample, and calculate the fraction of modified bases from
the two (<code>FracMod</code>).</p>
<p>In the above example, we in addition also calculate the average
modification probability (<code>Pmod</code>), and you could also
calcualte the averge confidence of the <code>modkit</code> calls per
position (<code>AvgConf</code>). As we have set
<code>keep.reads = TRUE</code>, we get in addition also the read-level
assay from the input object (<code>mod_prob</code>) in which the reads
are grouped by sample:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assayNames</a></span><span class="op">(</span><span class="va">se_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Nmod"     "Nvalid"   "FracMod"  "Pmod"     "mod_prob"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">se_summary</span>, <span class="st">"mod_prob"</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 8539 rows and 2 columns</span></span>
<span><span class="co">#&gt;                       sample1        sample2</span></span>
<span><span class="co">#&gt;                &lt;SparseMatrix&gt; &lt;SparseMatrix&gt;</span></span>
<span><span class="co">#&gt; chr1:6929104:+   0:0:0.02:...      0:0:0:...</span></span>
<span><span class="co">#&gt; chr1:6929106:+   0:0:0.02:...      0:0:0:...</span></span>
<span><span class="co">#&gt; chr1:6929111:+   0:0:0.02:...      0:0:0:...</span></span>
<span><span class="co">#&gt; chr1:6929113:+   0:0:0.02:...      0:0:0:...</span></span>
<span><span class="co">#&gt; chr1:6929118:+   0:0:0.02:...      0:0:0:...</span></span>
<span><span class="co">#&gt; ...                       ...            ...</span></span>
<span><span class="co">#&gt; chr1:6941513:-      0:0:0:...      0:0:0:...</span></span>
<span><span class="co">#&gt; chr1:6941522:-      0:0:0:...      0:0:0:...</span></span>
<span><span class="co">#&gt; chr1:6941524:-      0:0:0:...      0:0:0:...</span></span>
<span><span class="co">#&gt; chr1:6941530:-      0:0:0:...      0:0:0:...</span></span>
<span><span class="co">#&gt; chr1:6941531:-      0:0:0:...      0:0:0:...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-data">Plot data<a class="anchor" aria-label="anchor" href="#plot-data"></a>
</h2>
<p>The collapsed data can then be visualized just like the summary-level
data using <code>plotRegion</code>, using the <code>tracks.reads</code>
argument instead of <code>tracks.summary</code> to select the type of
plot(s).</p>
<p>For reference, here we plot the summary-level data:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotRegion.html">plotRegion</a></span><span class="op">(</span><span class="va">se_summary</span>, region <span class="op">=</span> <span class="st">"chr1:6932700-6932800"</span>,</span>
<span>           tracks.summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>FracMod <span class="op">=</span> <span class="st">"Point"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="read-level-data_files/figure-html/plot-summary-1.png" width="576"></p>
<p>… and here we plot the read-level data of the same region:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotRegion.html">plotRegion</a></span><span class="op">(</span><span class="va">se</span>, region <span class="op">=</span> <span class="st">"chr1:6932700-6932800"</span>,</span>
<span>           tracks.summary <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           tracks.reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod_prob <span class="op">=</span> <span class="st">"Heatmap"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="read-level-data_files/figure-html/plot-region-1.png" width="768"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotRegion.html">plotRegion</a></span><span class="op">(</span><span class="va">se</span>, region <span class="op">=</span> <span class="st">"chr1:6932700-6932800"</span>,</span>
<span>           tracks.summary <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           tracks.reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod_prob <span class="op">=</span> <span class="st">"Lollipop"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="read-level-data_files/figure-html/plot-region-2.png" width="768"></p>
<p>The x-axis in these plots is in “base-space”, meaning that it shows
the genomic coordinate on which the modified bases are irregularly
spaced. Alternatively, we can also generate these plot in
“modbase-space”, in which only modified bases are shown and the gaps
between them are removed:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotRegion.html">plotRegion</a></span><span class="op">(</span><span class="va">se</span>, region <span class="op">=</span> <span class="st">"chr1:6932700-6932800"</span>,</span>
<span>           tracks.summary <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           tracks.reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod_prob <span class="op">=</span> <span class="st">"Heatmap"</span><span class="op">)</span>,</span>
<span>           modbaseSpace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="read-level-data_files/figure-html/plot-region-modbasespace-1.png" width="768"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotRegion.html">plotRegion</a></span><span class="op">(</span><span class="va">se</span>, region <span class="op">=</span> <span class="st">"chr1:6932700-6932800"</span>,</span>
<span>           tracks.summary <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           tracks.reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod_prob <span class="op">=</span> <span class="st">"Lollipop"</span><span class="op">)</span>,</span>
<span>           modbaseSpace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="read-level-data_files/figure-html/plot-region-modbasespace-2.png" width="768">
## Session info</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sonoma 14.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] SummarizedExperiment_1.35.1 Biobase_2.65.0             </span></span>
<span><span class="co">#&gt;  [3] GenomicRanges_1.57.1        GenomeInfoDb_1.41.1        </span></span>
<span><span class="co">#&gt;  [5] IRanges_2.39.1              S4Vectors_0.43.1           </span></span>
<span><span class="co">#&gt;  [7] BiocGenerics_0.51.0         MatrixGenerics_1.17.0      </span></span>
<span><span class="co">#&gt;  [9] matrixStats_1.3.0           footprintR_0.1.0           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] tidyselect_1.2.1            farver_2.1.2               </span></span>
<span><span class="co">#&gt;  [3] dplyr_1.1.4                 R.utils_2.12.3             </span></span>
<span><span class="co">#&gt;  [5] Biostrings_2.73.1           bitops_1.0-7               </span></span>
<span><span class="co">#&gt;  [7] fastmap_1.2.0               SingleCellExperiment_1.27.2</span></span>
<span><span class="co">#&gt;  [9] RCurl_1.98-1.16             GenomicAlignments_1.41.0   </span></span>
<span><span class="co">#&gt; [11] XML_3.99-0.17               digest_0.6.36              </span></span>
<span><span class="co">#&gt; [13] lifecycle_1.0.4             magrittr_2.0.3             </span></span>
<span><span class="co">#&gt; [15] compiler_4.4.1              rlang_1.1.4                </span></span>
<span><span class="co">#&gt; [17] sass_0.4.9                  tools_4.4.1                </span></span>
<span><span class="co">#&gt; [19] utf8_1.2.4                  yaml_2.3.9                 </span></span>
<span><span class="co">#&gt; [21] data.table_1.15.4           rtracklayer_1.65.0         </span></span>
<span><span class="co">#&gt; [23] knitr_1.48                  labeling_0.4.3             </span></span>
<span><span class="co">#&gt; [25] S4Arrays_1.5.4              curl_5.2.1                 </span></span>
<span><span class="co">#&gt; [27] DelayedArray_0.31.8         abind_1.4-5                </span></span>
<span><span class="co">#&gt; [29] BiocParallel_1.39.0         withr_3.0.0                </span></span>
<span><span class="co">#&gt; [31] purrr_1.0.2                 desc_1.4.3                 </span></span>
<span><span class="co">#&gt; [33] R.oo_1.26.0                 grid_4.4.1                 </span></span>
<span><span class="co">#&gt; [35] fansi_1.0.6                 beachmat_2.21.4            </span></span>
<span><span class="co">#&gt; [37] colorspace_2.1-0            ggplot2_3.5.1              </span></span>
<span><span class="co">#&gt; [39] scales_1.3.0                cli_3.6.3                  </span></span>
<span><span class="co">#&gt; [41] rmarkdown_2.27              crayon_1.5.3               </span></span>
<span><span class="co">#&gt; [43] ragg_1.3.2                  generics_0.1.3             </span></span>
<span><span class="co">#&gt; [45] httr_1.4.7                  rjson_0.2.21               </span></span>
<span><span class="co">#&gt; [47] DelayedMatrixStats_1.27.2   scuttle_1.15.1             </span></span>
<span><span class="co">#&gt; [49] cachem_1.1.0                zlibbioc_1.51.1            </span></span>
<span><span class="co">#&gt; [51] parallel_4.4.1              XVector_0.45.0             </span></span>
<span><span class="co">#&gt; [53] restfulr_0.0.15             vctrs_0.6.5                </span></span>
<span><span class="co">#&gt; [55] Matrix_1.7-0                jsonlite_1.8.8             </span></span>
<span><span class="co">#&gt; [57] patchwork_1.2.0             systemfonts_1.1.0          </span></span>
<span><span class="co">#&gt; [59] jquerylib_0.1.4             glue_1.7.0                 </span></span>
<span><span class="co">#&gt; [61] pkgdown_2.1.0.9000          codetools_0.2-20           </span></span>
<span><span class="co">#&gt; [63] gtable_0.3.5                BiocIO_1.15.0              </span></span>
<span><span class="co">#&gt; [65] UCSC.utils_1.1.0            munsell_0.5.1              </span></span>
<span><span class="co">#&gt; [67] tibble_3.2.1                pillar_1.9.0               </span></span>
<span><span class="co">#&gt; [69] htmltools_0.5.8.1           GenomeInfoDbData_1.2.12    </span></span>
<span><span class="co">#&gt; [71] BSgenome_1.73.0             R6_2.5.1                   </span></span>
<span><span class="co">#&gt; [73] textshaping_0.4.0           sparseMatrixStats_1.17.2   </span></span>
<span><span class="co">#&gt; [75] evaluate_0.24.0             lattice_0.22-6             </span></span>
<span><span class="co">#&gt; [77] highr_0.11                  R.methodsS3_1.8.2          </span></span>
<span><span class="co">#&gt; [79] Rsamtools_2.21.0            bslib_0.7.0                </span></span>
<span><span class="co">#&gt; [81] Rcpp_1.0.13                 SparseArray_1.5.21         </span></span>
<span><span class="co">#&gt; [83] xfun_0.45                   fs_1.6.4                   </span></span>
<span><span class="co">#&gt; [85] pkgconfig_2.0.3</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Stadler, Charlotte Soneson, Panagiotis Papasaikas, Sebastien Smallwood.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

      </footer>
</div>






  </body>
</html>
